//
//  SGMalwareDetected.m
//  SafeGuardiOS
//
//  Created by Khousic on 19/12/24.
//

#import "SGMalwareDetected.h"

@implementation SGMalwareDetected

- (instancetype)init {
    self = [super init];
    if (self) {
        
    }
    return self;
}

-(BOOL)malwareDetected{
    UIWindow *mainWindow = [UIApplication sharedApplication].keyWindow;
    NSArray *windows = [UIApplication sharedApplication].windows;
    for (UIWindow *window in windows) {
        if ([window isKindOfClass:NSClassFromString(@"UITextEffectsWindow")]) {
            continue;
        }
        if (window != mainWindow && !window.isHidden) {
            NSLog(@"Suspicious overlay detected: %@", window);
            return YES;
        }
    }
    return NO;
}

@end
